ChatPage.jsx — Very beginner-friendly walkthrough

File path: frontend/src/components/ChatPage.jsx (or ChatPage.jsx inside components)
Purpose: Renders the full chat interface for a selected conversation: message list, message bubble layout, input box, attachment controls, and typing indicator.

What the user sees
- Header with the conversation partner's name and avatar.
- A vertical list of messages; your messages are aligned to the right, their messages to the left (common chat layout).
- Input area to type, attach images, and send messages.

Step-by-step explanation of how ChatPage works
1) Receive the conversation id
   - The page will have a conversation id from the URL or from the left conversation list.
2) Fetch message history
   - Call the API to load the conversation messages and render them chronologically from top (older) to bottom (newer).
3) Render messages as bubbles
   - Each message shows who sent it, the text, and a small timestamp. For long messages the bubble wraps.
4) Send message flow
   - User types and clicks Send.
   - The client may add the message to the UI immediately (optimistic update) while sending it to the server behind the scenes.
   - The server confirms and returns the saved message (with id), and the client updates the optimistic message with the real id to avoid duplicates.
5) Typing indicator
   - While the other user is typing, a small indicator ("Alice is typing…") appears. This is implemented by sending short socket events (e.g., typing-start/typing-stop).

Simple analogies
- Think of ChatPage as a chat window like WhatsApp: messages form a timeline, newest at the bottom.

Common pitfalls and solutions
- Out-of-order messages: ensure timestamps are used and server time is trusted, or messages are ordered using sequence numbers.
- File attachments failing: provide file size/type validation and show clear error messages.

Testing steps for beginners
1. Open the conversation and verify you can see past messages.
2. Type a message and press Send — confirm it appears right away.
3. Use a second browser to ensure messages appear in real-time.
4. Try sending an image; confirm it uploads and shows as an image bubble.

Developer notes
- Messages typically have a unique id from the backend; use that id to avoid duplicates.
- Message UI may use virtualization for large histories (e.g., react-window) to avoid performance issues.

Next reading
- `docs/components/messages.txt` — explains conversations list and overall message flow.
